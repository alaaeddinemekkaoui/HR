{% extends 'base.html' %}
{% load roles_extras %}
{% block title %}Documents{% endblock %}
{% block content %}
<div class="mb-4">
  <h1 class="h3 mb-1">Documents</h1>
  <p class="text-muted">Générez vos documents officiels ou gérez des modèles dynamiques.</p>
</div>

<div class="row g-4">
  <div class="col-lg-6">
    <div class="card border-0 shadow-sm">
      <div class="card-header bg-white border-bottom">
        <h6 class="mb-0"><i class="bi bi-person-badge text-primary"></i> Mes documents</h6>
      </div>
      <div class="card-body">
        {% if employee %}
        <div class="d-grid gap-2">
          <a href="{% url 'documents:attestation_travail' employee.id %}" class="btn btn-outline-primary">
            <i class="bi bi-file-earmark-text"></i> Attestation de travail
          </a>
          <a href="{% url 'documents:attestation_salaire' employee.id %}" class="btn btn-outline-secondary">
            <i class="bi bi-currency-exchange"></i> Attestation de salaire
          </a>
        </div>
        {% else %}
          <p class="text-muted">Aucun profil employé lié à votre compte.</p>
        {% endif %}
      </div>
    </div>
  </div>

  {% if request.user.is_superuser or request.user|has_group:'IT Admin' or request.user|has_group:'HR Admin' or request.user|has_group:'HR' %}
  <div class="col-lg-6">
    <div class="card border-0 shadow-sm">
      <div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center">
        <h6 class="mb-0"><i class="bi bi-tools text-primary"></i> Modèles dynamiques (RH)</h6>
        <a href="{% url 'documents:template_list' %}" class="btn btn-sm btn-outline-primary">Gérer les modèles</a>
      </div>
      <div class="card-body">
        {% if templates %}
          <ul class="list-group list-group-flush">
            {% for t in templates %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <div class="fw-semibold">{{ t.name }}</div>
                <small class="text-muted">/{{ t.slug }}/</small>
              </div>
              <a class="btn btn-sm btn-outline-secondary" href="{% url 'documents:template_render' t.slug %}">Générer</a>
            </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted mb-0">Aucun modèle pour le moment.</p>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}
